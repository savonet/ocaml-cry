<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cry (cry.Cry)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">cry</a> &#x00BB; Cry</nav><header class="odoc-preamble"><h1>Module <code><span>Cry</span></code></h1><p>Native implementation of the shout source protocols * for icecast and shoutcast.</p></header><nav class="odoc-toc"><ul><li><a href="#description">Description</a></li><li><a href="#types-and-errors">Types and errors</a></li><li><a href="#api">API</a></li></ul></nav><div class="odoc-content"><h3 id="description"><a href="#description" class="anchor"></a>Description</h3><p>* * <code>Cry</code> implements the protocols used to connect and send source data to * icecast2 and shoutcast servers. * * It is a low-level implementation that minimally manages source * connections. In particular, it does not handle synchronisation, unlike * the main implementation libshout. Hence, the task of sending audio data * to the streaming server at real time rate is left to the application.</p><h3 id="types-and-errors"><a href="#types-and-errors" class="anchor"></a>Types and errors</h3><div class="odoc-spec"><div class="spec type anchored" id="type-event"><a href="#type-event" class="anchor"></a><code><span><span class="keyword">type</span> event</span><span> = </span><span>[ </span></code><ol><li id="type-event.Read" class="def variant constructor anchored"><a href="#type-event.Read" class="anchor"></a><code><span>| </span><span>`Read</span></code></li><li id="type-event.Write" class="def variant constructor anchored"><a href="#type-event.Write" class="anchor"></a><code><span>| </span><span>`Write</span></code></li><li id="type-event.Both" class="def variant constructor anchored"><a href="#type-event.Both" class="anchor"></a><code><span>| </span><span>`Both</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-socket"><a href="#type-socket" class="anchor"></a><code><span><span class="keyword">type</span> socket</span><span> =
  <span>&lt; typ : string
  ; transport : <a href="#type-transport">transport</a>
  ; file_descr : <span class="xref-unresolved">Unix</span>.file_descr
  ; wait_for : <span><span class="optlabel">?log</span>:<span>(<span>string <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> unit
  ; write : <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> int
  ; read : <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> int
  ; close : unit &gt;</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-transport"><a href="#type-transport" class="anchor"></a><code><span><span class="keyword">and</span> transport</span><span> =
  <span>&lt; name : string
  ; protocol : string
  ; default_port : int
  ; connect : 
    <span><span class="optlabel">?bind_address</span>:string <span class="arrow">&#45;&gt;</span></span>
    <span><span class="optlabel">?timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
    <span><span class="optlabel">?prefer</span>:<span>[ `System_default <span>| `Ipv4</span> <span>| `Ipv6</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
    <span>string <span class="arrow">&#45;&gt;</span></span>
    <span>int <span class="arrow">&#45;&gt;</span></span>
    <a href="#type-socket">socket</a> &gt;</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-error"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = </span></code><ol><li id="type-error.Create" class="def variant constructor anchored"><a href="#type-error.Create" class="anchor"></a><code><span>| </span><span><span class="constructor">Create</span> <span class="keyword">of</span> exn</span></code></li><li id="type-error.Connect" class="def variant constructor anchored"><a href="#type-error.Connect" class="anchor"></a><code><span>| </span><span><span class="constructor">Connect</span> <span class="keyword">of</span> exn</span></code></li><li id="type-error.Close" class="def variant constructor anchored"><a href="#type-error.Close" class="anchor"></a><code><span>| </span><span><span class="constructor">Close</span> <span class="keyword">of</span> exn</span></code></li><li id="type-error.Write" class="def variant constructor anchored"><a href="#type-error.Write" class="anchor"></a><code><span>| </span><span><span class="constructor">Write</span> <span class="keyword">of</span> exn</span></code></li><li id="type-error.Read" class="def variant constructor anchored"><a href="#type-error.Read" class="anchor"></a><code><span>| </span><span><span class="constructor">Read</span> <span class="keyword">of</span> exn</span></code></li><li id="type-error.Busy" class="def variant constructor anchored"><a href="#type-error.Busy" class="anchor"></a><code><span>| </span><span><span class="constructor">Busy</span></span></code></li><li id="type-error.Ssl_unavailable" class="def variant constructor anchored"><a href="#type-error.Ssl_unavailable" class="anchor"></a><code><span>| </span><span><span class="constructor">Ssl_unavailable</span></span></code></li><li id="type-error.Not_connected" class="def variant constructor anchored"><a href="#type-error.Not_connected" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_connected</span></span></code></li><li id="type-error.Invalid_usage" class="def variant constructor anchored"><a href="#type-error.Invalid_usage" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid_usage</span></span></code></li><li id="type-error.Unknown_host" class="def variant constructor anchored"><a href="#type-error.Unknown_host" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_host</span> <span class="keyword">of</span> string</span></code></li><li id="type-error.Bad_answer" class="def variant constructor anchored"><a href="#type-error.Bad_answer" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_answer</span> <span class="keyword">of</span> <span>string option</span></span></code></li><li id="type-error.Http_answer" class="def variant constructor anchored"><a href="#type-error.Http_answer" class="anchor"></a><code><span>| </span><span><span class="constructor">Http_answer</span> <span class="keyword">of</span> int * string * string</span></code></li></ol></div><div class="spec-doc"><p>Possible errors.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Error</span> <span class="keyword">of</span> <a href="#type-error">error</a></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Timeout"><a href="#exception-Timeout" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Timeout</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unix_connect"><a href="#val-unix_connect" class="anchor"></a><code><span><span class="keyword">val</span> unix_connect : 
  <span><span class="optlabel">?bind_address</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?prefer</span>:<span>[ `System_default <span>| `Ipv4</span> <span>| `Ipv6</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Unix</span>.file_descr</span></code></div><div class="spec-doc"><p>Base unix connect</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unix_transport"><a href="#val-unix_transport" class="anchor"></a><code><span><span class="keyword">val</span> unix_transport : <a href="#type-transport">transport</a></span></code></div><div class="spec-doc"><p>Unix transport and socket.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unix_socket"><a href="#val-unix_socket" class="anchor"></a><code><span><span class="keyword">val</span> unix_socket : <span><span class="xref-unresolved">Unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span> <a href="#type-socket">socket</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_error"><a href="#val-string_of_error" class="anchor"></a><code><span><span class="keyword">val</span> string_of_error : <span>exn <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get a string explaining an error.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-verb"><a href="#type-verb" class="anchor"></a><code><span><span class="keyword">type</span> verb</span><span> = </span></code><ol><li id="type-verb.Put" class="def variant constructor anchored"><a href="#type-verb.Put" class="anchor"></a><code><span>| </span><span><span class="constructor">Put</span></span></code></li><li id="type-verb.Post" class="def variant constructor anchored"><a href="#type-verb.Post" class="anchor"></a><code><span>| </span><span><span class="constructor">Post</span></span></code></li><li id="type-verb.Source" class="def variant constructor anchored"><a href="#type-verb.Source" class="anchor"></a><code><span>| </span><span><span class="constructor">Source</span></span></code></li></ol></div><div class="spec-doc"><p>Possible verbs for HTTP streaming. Default: <code>Source</code></p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-protocol"><a href="#type-protocol" class="anchor"></a><code><span><span class="keyword">type</span> protocol</span><span> = </span></code><ol><li id="type-protocol.Icy" class="def variant constructor anchored"><a href="#type-protocol.Icy" class="anchor"></a><code><span>| </span><span><span class="constructor">Icy</span></span></code></li><li id="type-protocol.Http" class="def variant constructor anchored"><a href="#type-protocol.Http" class="anchor"></a><code><span>| </span><span><span class="constructor">Http</span> <span class="keyword">of</span> <a href="#type-verb">verb</a></span></code></li></ol></div><div class="spec-doc"><p>Possible protocols. <code>Icy</code> is the (undocumented) shoutcast source protocol. * <code>Http</code> is the icecast2 source protocol. * * Ogg streaming is only possible with <code>Http</code>. Any headerless format, * (e.g. mpeg containers), should work with both protocols, * provided you set the correct content-type (mime) for the source.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_protocol"><a href="#val-string_of_protocol" class="anchor"></a><code><span><span class="keyword">val</span> string_of_protocol : <span><a href="#type-protocol">protocol</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return a string representation of a protocol.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-content_type"><a href="#type-content_type" class="anchor"></a><code><span><span class="keyword">type</span> content_type</span></code></div><div class="spec-doc"><p>Special type for content-type (mime) data.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ogg_application"><a href="#val-ogg_application" class="anchor"></a><code><span><span class="keyword">val</span> ogg_application : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>General mime type for ogg data.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ogg_audio"><a href="#val-ogg_audio" class="anchor"></a><code><span><span class="keyword">val</span> ogg_audio : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Mime type for audio data encapsulated using ogg.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ogg_video"><a href="#val-ogg_video" class="anchor"></a><code><span><span class="keyword">val</span> ogg_video : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Mime type for video data encapsulated using ogg.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mpeg"><a href="#val-mpeg" class="anchor"></a><code><span><span class="keyword">val</span> mpeg : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Mime type for mpeg audio data (mp3).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-content_type_of_string"><a href="#val-content_type_of_string" class="anchor"></a><code><span><span class="keyword">val</span> content_type_of_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Create a mime type from a string (e.g. &quot;audio/aacp&quot;)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_content_type"><a href="#val-string_of_content_type" class="anchor"></a><code><span><span class="keyword">val</span> string_of_content_type : <span><a href="#type-content_type">content_type</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the string representation of a mime type.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mount"><a href="#type-mount" class="anchor"></a><code><span><span class="keyword">type</span> mount</span><span> = </span></code><ol><li id="type-mount.Icy_id" class="def variant constructor anchored"><a href="#type-mount.Icy_id" class="anchor"></a><code><span>| </span><span><span class="constructor">Icy_id</span> <span class="keyword">of</span> int</span></code></li><li id="type-mount.Icecast_mount" class="def variant constructor anchored"><a href="#type-mount.Icecast_mount" class="anchor"></a><code><span>| </span><span><span class="constructor">Icecast_mount</span> <span class="keyword">of</span> string</span></code></li></ol></div><div class="spec-doc"><p>Type for a mount point. <code>Icy_id</code> are for Shoutcast v2 * sid. For Shoutcast v1, use <code>Icy_id 1</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-connection"><a href="#type-connection" class="anchor"></a><code><span><span class="keyword">type</span> connection</span><span> = </span><span>{</span></code><ol><li id="type-connection.mount" class="def record field anchored"><a href="#type-connection.mount" class="anchor"></a><code><span>mount : <a href="#type-mount">mount</a>;</span></code></li><li id="type-connection.user" class="def record field anchored"><a href="#type-connection.user" class="anchor"></a><code><span>user : string;</span></code></li><li id="type-connection.password" class="def record field anchored"><a href="#type-connection.password" class="anchor"></a><code><span>password : string;</span></code></li><li id="type-connection.host" class="def record field anchored"><a href="#type-connection.host" class="anchor"></a><code><span>host : string;</span></code></li><li id="type-connection.port" class="def record field anchored"><a href="#type-connection.port" class="anchor"></a><code><span>port : int;</span></code></li><li id="type-connection.chunked" class="def record field anchored"><a href="#type-connection.chunked" class="anchor"></a><code><span>chunked : bool;</span></code></li><li id="type-connection.content_type" class="def record field anchored"><a href="#type-connection.content_type" class="anchor"></a><code><span>content_type : <a href="#type-content_type">content_type</a>;</span></code></li><li id="type-connection.protocol" class="def record field anchored"><a href="#type-connection.protocol" class="anchor"></a><code><span>protocol : <a href="#type-protocol">protocol</a>;</span></code></li><li id="type-connection.headers" class="def record field anchored"><a href="#type-connection.headers" class="anchor"></a><code><span>headers : <span><span>(string, string)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Type for a source connection. * * <code>headers</code> is a hash table containing the headers. * See <code>connection</code> function for more details.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_connection"><a href="#val-string_of_connection" class="anchor"></a><code><span><span class="keyword">val</span> string_of_connection : <span><a href="#type-connection">connection</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Returns a JSON string representation of a connection.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-audio_info"><a href="#type-audio_info" class="anchor"></a><code><span><span class="keyword">type</span> audio_info</span><span> = <span><span>(string, string)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div><div class="spec-doc"><p>Type for audio informations. Used for connection headers. * See <code>audio_info</code> function for more details.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-metadata"><a href="#type-metadata" class="anchor"></a><code><span><span class="keyword">type</span> metadata</span><span> = <span><span>(string, string)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div><div class="spec-doc"><p>Type for metadata values.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-connection_data"><a href="#type-connection_data" class="anchor"></a><code><span><span class="keyword">type</span> connection_data</span><span> = </span><span>{</span></code><ol><li id="type-connection_data.connection" class="def record field anchored"><a href="#type-connection_data.connection" class="anchor"></a><code><span>connection : <a href="#type-connection">connection</a>;</span></code></li><li id="type-connection_data.socket" class="def record field anchored"><a href="#type-connection_data.socket" class="anchor"></a><code><span>socket : <a href="#type-socket">socket</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-status"><a href="#type-status" class="anchor"></a><code><span><span class="keyword">type</span> status</span><span> = </span></code><ol><li id="type-status.Connected" class="def variant constructor anchored"><a href="#type-status.Connected" class="anchor"></a><code><span>| </span><span><span class="constructor">Connected</span> <span class="keyword">of</span> <a href="#type-connection_data">connection_data</a></span></code></li><li id="type-status.Disconnected" class="def variant constructor anchored"><a href="#type-status.Disconnected" class="anchor"></a><code><span>| </span><span><span class="constructor">Disconnected</span></span></code></li></ol></div><div class="spec-doc"><p>Type for the status of a handler.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Type for the main handler.</p></div></div><h3 id="api"><a href="#api" class="anchor"></a>API</h3><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span class="optlabel">?bind_address</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?connection_timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?transport</span>:<a href="#type-transport">transport</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Create a new handler. * * <code>bind</code> is not used by default (system default). * <code>timeout</code> is <code>30.</code> by default.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_status"><a href="#val-get_status" class="anchor"></a><code><span><span class="keyword">val</span> get_status : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-status">status</a></span></code></div><div class="spec-doc"><p>Get a handler's status</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_icy_cap"><a href="#val-get_icy_cap" class="anchor"></a><code><span><span class="keyword">val</span> get_icy_cap : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Get a handler's ICY capabilities. * For the <code>Http</code> protocol, this is always true. * For the <code>Icy</code> protocol, this is detected upon connecting.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_connection_data"><a href="#val-get_connection_data" class="anchor"></a><code><span><span class="keyword">val</span> get_connection_data : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-connection_data">connection_data</a></span></code></div><div class="spec-doc"><p>Get data associated with a connection. Use it only if you know * what you are doing. * * Raises: <code>Error Not_connected</code> if not connected.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-audio_info"><a href="#val-audio_info" class="anchor"></a><code><span><span class="keyword">val</span> audio_info : 
  <span><span class="optlabel">?samplerate</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?channels</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?quality</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bitrate</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-audio_info">audio_info</a></span></code></div><div class="spec-doc"><p>Create a new <code>audio_info</code> value, * filed with given values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-connection"><a href="#val-connection" class="anchor"></a><code><span><span class="keyword">val</span> connection : 
  <span><span class="optlabel">?user_agent</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?genre</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?url</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?public</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?audio_info</span>:<a href="#type-audio_info">audio_info</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?description</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?host</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?port</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chunked</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?password</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?protocol</span>:<a href="#type-protocol">protocol</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?user</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">mount</span>:<a href="#type-mount">mount</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">content_type</span>:<a href="#type-content_type">content_type</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-connection">connection</a></span></code></div><div class="spec-doc"><p>Create a new <code>connection</code> value * with default values. * * <code>mount</code> is mandatory when using the <code>Http</code> protocol. * <code>icy_id</code> is mandatory to support multiple shoutcast sources * on shoutcast v2. * * <code>host</code> is <code>&quot;localhost&quot;</code> by default. * <code>password</code> is <code>&quot;hackme&quot;</code> by default. * <code>user</code> is <code>&quot;source&quot;</code> by default. Change <code>user</code> only if you know * what your are doing. * <code>protocol</code> is <code>Http</code> by default. * <code>port</code> is <code>8000</code> by default. * <code>chunked</code> is <code>false</code> by default and only works with HTTP/1.1-capable * servers. * * The list of preset headers for <code>Http</code> connections is: * <code>&quot;User-Agent&quot;</code>, <code>&quot;ice-name&quot;</code>, <code>&quot;ice-genre&quot;</code>, * <code>&quot;ice-url&quot;</code>, <code>&quot;ice-public&quot;</code>, <code>&quot;ice-audio-info&quot;</code>, * <code>&quot;ice-description&quot;</code>. * * The list of preset headers for <code>Icy</code> connections is: * <code>&quot;User-Agent&quot;</code>, <code>&quot;icy-name&quot;</code>, <code>&quot;icy-url&quot;</code>, <code>&quot;icy-pub&quot;</code>, * <code>&quot;icy-genre&quot;</code>, <code>&quot;icy-br&quot;</code>. * * Additionally, you can also add: * <code>&quot;icy-irc&quot;</code>, <code>&quot;icy-icq&quot;</code> and <code>&quot;icy-aim&quot;</code> but these are not added * by this function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-connect"><a href="#val-connect" class="anchor"></a><code><span><span class="keyword">val</span> connect : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-connection">connection</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Connect a handler.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_metadata"><a href="#val-update_metadata" class="anchor"></a><code><span><span class="keyword">val</span> update_metadata : <span><span class="optlabel">?charset</span>:string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-metadata">metadata</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Update metadata on a handler. Useful only for non-ogg data format, * and if <code>icy_cap</code> is <code>true</code> for <code>Icy</code> connections. * * For <code>Icy</code> protocol, the relevant metadata are only <code>&quot;song&quot;</code> * and <code>&quot;url&quot;</code>. * * Raises: <code>Error Not_connected</code> * if not connected.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-manual_update_metadata"><a href="#val-manual_update_metadata" class="anchor"></a><code><span><span class="keyword">val</span> manual_update_metadata : 
  <span><span class="label">host</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">port</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">protocol</span>:<a href="#type-protocol">protocol</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">user</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">password</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">mount</span>:<a href="#type-mount">mount</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?connection_timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?headers</span>:<span><span>(string, string)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bind_address</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?charset</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?transport</span>:<a href="#type-transport">transport</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-metadata">metadata</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Manually update metadata on any source without necessarily * being connected to it for streaming. * * Optional <code>timeout</code> is <code>30.</code> by default. * * Use it only if you know what you are doing !</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-send"><a href="#val-send" class="anchor"></a><code><span><span class="keyword">val</span> send : <span><span class="optlabel">?offset</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?length</span>:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Send data to a source connection. * * Raises: <code>Error Not_connected</code> * if not connected.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close a source connection. * * Raises: <code>Error Not_connected</code> * if not connected.</p></div></div></div></body></html>
