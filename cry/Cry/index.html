<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cry (cry.Cry)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">cry</a> &#x00BB; Cry</nav><header class="odoc-preamble"><h1>Module <code><span>Cry</span></code></h1><p>Native implementation of the shout source protocols * for icecast and shoutcast.</p></header><nav class="odoc-toc"><ul><li><a href="#description">Description</a></li><li><a href="#types-and-errors">Types and errors</a></li><li><a href="#api">API</a></li></ul></nav><div class="odoc-content"><h3 id="description"><a href="#description" class="anchor"></a>Description</h3><p>* * <code>Cry</code> implements the protocols used to connect and send source data to * icecast2 and shoutcast servers. * * It is a low-level implementation that minimally manages source * connections. In particular, it does not handle synchronisation, unlike * the main implementation libshout. Hence, the task of sending audio data * to the streaming server at real time rate is left to the application.</p><h3 id="types-and-errors"><a href="#types-and-errors" class="anchor"></a>Types and errors</h3><div class="odoc-spec"><div class="spec type" id="type-operation" class="anchored"><a href="#type-operation" class="anchor"></a><code><span><span class="keyword">type</span> operation</span><span> = </span><span>[ </span></code><table><tr id="type-operation.Read" class="anchored"><td class="def constructor"><a href="#type-operation.Read" class="anchor"></a><code><span>| </span></code><code><span>`Read</span></code></td></tr><tr id="type-operation.Write" class="anchored"><td class="def constructor"><a href="#type-operation.Write" class="anchor"></a><code><span>| </span></code><code><span>`Write</span></code></td></tr><tr id="type-operation.Both" class="anchored"><td class="def constructor"><a href="#type-operation.Both" class="anchor"></a><code><span>| </span></code><code><span>`Both</span></code></td></tr></table><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-transport" class="anchored"><a href="#type-transport" class="anchor"></a><code><span><span class="keyword">type</span> transport</span><span> = </span><span>{</span></code><table><tr id="type-transport.write" class="anchored"><td class="def record field"><a href="#type-transport.write" class="anchor"></a><code><span>write : <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> int;</span></code></td></tr><tr id="type-transport.read" class="anchored"><td class="def record field"><a href="#type-transport.read" class="anchor"></a><code><span>read : <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> int;</span></code></td></tr><tr id="type-transport.wait_for" class="anchored"><td class="def record field"><a href="#type-transport.wait_for" class="anchor"></a><code><span>wait_for : <span><a href="#type-operation">operation</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> bool;</span></code></td></tr><tr id="type-transport.close" class="anchored"><td class="def record field"><a href="#type-transport.close" class="anchor"></a><code><span>close : <span>unit <span class="arrow">&#45;&gt;</span></span> unit;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-error" class="anchored"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = </span></code><table><tr id="type-error.Create" class="anchored"><td class="def variant constructor"><a href="#type-error.Create" class="anchor"></a><code><span>| </span><span><span class="constructor">Create</span> <span class="keyword">of</span> exn</span></code></td></tr><tr id="type-error.Connect" class="anchored"><td class="def variant constructor"><a href="#type-error.Connect" class="anchor"></a><code><span>| </span><span><span class="constructor">Connect</span> <span class="keyword">of</span> exn</span></code></td></tr><tr id="type-error.Close" class="anchored"><td class="def variant constructor"><a href="#type-error.Close" class="anchor"></a><code><span>| </span><span><span class="constructor">Close</span> <span class="keyword">of</span> exn</span></code></td></tr><tr id="type-error.Write" class="anchored"><td class="def variant constructor"><a href="#type-error.Write" class="anchor"></a><code><span>| </span><span><span class="constructor">Write</span> <span class="keyword">of</span> exn</span></code></td></tr><tr id="type-error.Read" class="anchored"><td class="def variant constructor"><a href="#type-error.Read" class="anchor"></a><code><span>| </span><span><span class="constructor">Read</span> <span class="keyword">of</span> exn</span></code></td></tr><tr id="type-error.Busy" class="anchored"><td class="def variant constructor"><a href="#type-error.Busy" class="anchor"></a><code><span>| </span><span><span class="constructor">Busy</span></span></code></td></tr><tr id="type-error.Ssl_unavailable" class="anchored"><td class="def variant constructor"><a href="#type-error.Ssl_unavailable" class="anchor"></a><code><span>| </span><span><span class="constructor">Ssl_unavailable</span></span></code></td></tr><tr id="type-error.Not_connected" class="anchored"><td class="def variant constructor"><a href="#type-error.Not_connected" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_connected</span></span></code></td></tr><tr id="type-error.Invalid_usage" class="anchored"><td class="def variant constructor"><a href="#type-error.Invalid_usage" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid_usage</span></span></code></td></tr><tr id="type-error.Unknown_host" class="anchored"><td class="def variant constructor"><a href="#type-error.Unknown_host" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_host</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="type-error.Bad_answer" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_answer" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_answer</span> <span class="keyword">of</span> <span>string option</span></span></code></td></tr><tr id="type-error.Http_answer" class="anchored"><td class="def variant constructor"><a href="#type-error.Http_answer" class="anchor"></a><code><span>| </span><span><span class="constructor">Http_answer</span> <span class="keyword">of</span> int * string * string</span></code></td></tr></table></div><div class="spec-doc"><p>Possible errors.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Error" class="anchored"><a href="#exception-Error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Error</span> <span class="keyword">of</span> <a href="#type-error">error</a></span></code></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Timeout" class="anchored"><a href="#exception-Timeout" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Timeout</span></span></code></div></div><p>Optional ssl module</p><div class="odoc-spec"><div class="spec value" id="val-register_https" class="anchored"><a href="#val-register_https" class="anchor"></a><code><span><span class="keyword">val</span> register_https : <span><span>( <span>host:string <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span> <a href="#type-transport">transport</a> )</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a transport module to be used for SSL connections.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_error" class="anchored"><a href="#val-string_of_error" class="anchor"></a><code><span><span class="keyword">val</span> string_of_error : <span>exn <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get a string explaining an error.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-verb" class="anchored"><a href="#type-verb" class="anchor"></a><code><span><span class="keyword">type</span> verb</span><span> = </span></code><table><tr id="type-verb.Put" class="anchored"><td class="def variant constructor"><a href="#type-verb.Put" class="anchor"></a><code><span>| </span><span><span class="constructor">Put</span></span></code></td></tr><tr id="type-verb.Post" class="anchored"><td class="def variant constructor"><a href="#type-verb.Post" class="anchor"></a><code><span>| </span><span><span class="constructor">Post</span></span></code></td></tr><tr id="type-verb.Source" class="anchored"><td class="def variant constructor"><a href="#type-verb.Source" class="anchor"></a><code><span>| </span><span><span class="constructor">Source</span></span></code></td></tr></table></div><div class="spec-doc"><p>Possible verbs for HTTP streaming. Default: <code>Source</code></p></div></div><div class="odoc-spec"><div class="spec type" id="type-protocol" class="anchored"><a href="#type-protocol" class="anchor"></a><code><span><span class="keyword">type</span> protocol</span><span> = </span></code><table><tr id="type-protocol.Icy" class="anchored"><td class="def variant constructor"><a href="#type-protocol.Icy" class="anchor"></a><code><span>| </span><span><span class="constructor">Icy</span></span></code></td></tr><tr id="type-protocol.Http" class="anchored"><td class="def variant constructor"><a href="#type-protocol.Http" class="anchor"></a><code><span>| </span><span><span class="constructor">Http</span> <span class="keyword">of</span> <a href="#type-verb">verb</a></span></code></td></tr><tr id="type-protocol.Https" class="anchored"><td class="def variant constructor"><a href="#type-protocol.Https" class="anchor"></a><code><span>| </span><span><span class="constructor">Https</span> <span class="keyword">of</span> <a href="#type-verb">verb</a></span></code></td></tr></table></div><div class="spec-doc"><p>Possible protocols. <code>Icy</code> is the (undocumented) shoutcast source protocol. * <code>Http</code> is the icecast2 source protocol. * <code>Https</code> is the icecast2 source protocol with TLS connection. * * Ogg streaming is only possible with <code>Http</code>. Any headerless format, * (e.g. mpeg containers), should work with both protocols, * provided you set the correct content-type (mime) for the source.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_protocol" class="anchored"><a href="#val-string_of_protocol" class="anchor"></a><code><span><span class="keyword">val</span> string_of_protocol : <span><a href="#type-protocol">protocol</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Return a string representation of a protocol.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-content_type" class="anchored"><a href="#type-content_type" class="anchor"></a><code><span><span class="keyword">type</span> content_type</span></code></div><div class="spec-doc"><p>Special type for content-type (mime) data.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ogg_application" class="anchored"><a href="#val-ogg_application" class="anchor"></a><code><span><span class="keyword">val</span> ogg_application : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>General mime type for ogg data.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ogg_audio" class="anchored"><a href="#val-ogg_audio" class="anchor"></a><code><span><span class="keyword">val</span> ogg_audio : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Mime type for audio data encapsulated using ogg.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ogg_video" class="anchored"><a href="#val-ogg_video" class="anchor"></a><code><span><span class="keyword">val</span> ogg_video : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Mime type for video data encapsulated using ogg.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-mpeg" class="anchored"><a href="#val-mpeg" class="anchor"></a><code><span><span class="keyword">val</span> mpeg : <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Mime type for mpeg audio data (mp3).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-content_type_of_string" class="anchored"><a href="#val-content_type_of_string" class="anchor"></a><code><span><span class="keyword">val</span> content_type_of_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-content_type">content_type</a></span></code></div><div class="spec-doc"><p>Create a mime type from a string (e.g. &quot;audio/aacp&quot;)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_content_type" class="anchored"><a href="#val-string_of_content_type" class="anchor"></a><code><span><span class="keyword">val</span> string_of_content_type : <span><a href="#type-content_type">content_type</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the string representation of a mime type.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-mount" class="anchored"><a href="#type-mount" class="anchor"></a><code><span><span class="keyword">type</span> mount</span><span> = </span></code><table><tr id="type-mount.Icy_id" class="anchored"><td class="def variant constructor"><a href="#type-mount.Icy_id" class="anchor"></a><code><span>| </span><span><span class="constructor">Icy_id</span> <span class="keyword">of</span> int</span></code></td></tr><tr id="type-mount.Icecast_mount" class="anchored"><td class="def variant constructor"><a href="#type-mount.Icecast_mount" class="anchor"></a><code><span>| </span><span><span class="constructor">Icecast_mount</span> <span class="keyword">of</span> string</span></code></td></tr></table></div><div class="spec-doc"><p>Type for a mount point. <code>Icy_id</code> are for Shoutcast v2 * sid. For Shoutcast v1, use <code>Icy_id 1</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-connection" class="anchored"><a href="#type-connection" class="anchor"></a><code><span><span class="keyword">type</span> connection</span><span> = </span><span>{</span></code><table><tr id="type-connection.mount" class="anchored"><td class="def record field"><a href="#type-connection.mount" class="anchor"></a><code><span>mount : <a href="#type-mount">mount</a>;</span></code></td></tr><tr id="type-connection.user" class="anchored"><td class="def record field"><a href="#type-connection.user" class="anchor"></a><code><span>user : string;</span></code></td></tr><tr id="type-connection.password" class="anchored"><td class="def record field"><a href="#type-connection.password" class="anchor"></a><code><span>password : string;</span></code></td></tr><tr id="type-connection.host" class="anchored"><td class="def record field"><a href="#type-connection.host" class="anchor"></a><code><span>host : string;</span></code></td></tr><tr id="type-connection.port" class="anchored"><td class="def record field"><a href="#type-connection.port" class="anchor"></a><code><span>port : int;</span></code></td></tr><tr id="type-connection.chunked" class="anchored"><td class="def record field"><a href="#type-connection.chunked" class="anchor"></a><code><span>chunked : bool;</span></code></td></tr><tr id="type-connection.content_type" class="anchored"><td class="def record field"><a href="#type-connection.content_type" class="anchor"></a><code><span>content_type : <a href="#type-content_type">content_type</a>;</span></code></td></tr><tr id="type-connection.protocol" class="anchored"><td class="def record field"><a href="#type-connection.protocol" class="anchor"></a><code><span>protocol : <a href="#type-protocol">protocol</a>;</span></code></td></tr><tr id="type-connection.headers" class="anchored"><td class="def record field"><a href="#type-connection.headers" class="anchor"></a><code><span>headers : <span><span>( string, string )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Type for a source connection. * * <code>headers</code> is a hash table containing the headers. * See <code>connection</code> function for more details.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_connection" class="anchored"><a href="#val-string_of_connection" class="anchor"></a><code><span><span class="keyword">val</span> string_of_connection : <span><a href="#type-connection">connection</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Returns a JSON string representation of a connection.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-audio_info" class="anchored"><a href="#type-audio_info" class="anchor"></a><code><span><span class="keyword">type</span> audio_info</span><span> = <span><span>( string, string )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div><div class="spec-doc"><p>Type for audio informations. Used for connection headers. * See <code>audio_info</code> function for more details.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-metadata" class="anchored"><a href="#type-metadata" class="anchor"></a><code><span><span class="keyword">type</span> metadata</span><span> = <span><span>( string, string )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div><div class="spec-doc"><p>Type for metadata values.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-connection_data" class="anchored"><a href="#type-connection_data" class="anchor"></a><code><span><span class="keyword">type</span> connection_data</span><span> = </span><span>{</span></code><table><tr id="type-connection_data.connection" class="anchored"><td class="def record field"><a href="#type-connection_data.connection" class="anchor"></a><code><span>connection : <a href="#type-connection">connection</a>;</span></code></td></tr><tr id="type-connection_data.transport" class="anchored"><td class="def record field"><a href="#type-connection_data.transport" class="anchor"></a><code><span>transport : <a href="#type-transport">transport</a>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-status" class="anchored"><a href="#type-status" class="anchor"></a><code><span><span class="keyword">type</span> status</span><span> = </span></code><table><tr id="type-status.Connected" class="anchored"><td class="def variant constructor"><a href="#type-status.Connected" class="anchor"></a><code><span>| </span><span><span class="constructor">Connected</span> <span class="keyword">of</span> <a href="#type-connection_data">connection_data</a></span></code></td></tr><tr id="type-status.Disconnected" class="anchored"><td class="def variant constructor"><a href="#type-status.Disconnected" class="anchor"></a><code><span>| </span><span><span class="constructor">Disconnected</span></span></code></td></tr></table></div><div class="spec-doc"><p>Type for the status of a handler.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Type for the main handler.</p></div></div><h3 id="api"><a href="#api" class="anchor"></a>API</h3><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?bind:string <span class="arrow">&#45;&gt;</span></span>
  <span>?connection_timeout:float <span class="arrow">&#45;&gt;</span></span>
  <span>?timeout:float <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Create a new handler. * * <code>bind</code> is not used by default (system default). * <code>timeout</code> is <code>30.</code> by default.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_status" class="anchored"><a href="#val-get_status" class="anchor"></a><code><span><span class="keyword">val</span> get_status : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-status">status</a></span></code></div><div class="spec-doc"><p>Get a handler's status</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_icy_cap" class="anchored"><a href="#val-get_icy_cap" class="anchor"></a><code><span><span class="keyword">val</span> get_icy_cap : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Get a handler's ICY capabilities. * For the <code>Http</code> protocol, this is always true. * For the <code>Icy</code> protocol, this is detected upon connecting.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_connection_data" class="anchored"><a href="#val-get_connection_data" class="anchor"></a><code><span><span class="keyword">val</span> get_connection_data : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-connection_data">connection_data</a></span></code></div><div class="spec-doc"><p>Get data associated with a connection. Use it only if you know * what you are doing. * * Raises: <code>Error Not_connected</code> if not connected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-audio_info" class="anchored"><a href="#val-audio_info" class="anchor"></a><code><span><span class="keyword">val</span> audio_info : 
  <span>?samplerate:int <span class="arrow">&#45;&gt;</span></span>
  <span>?channels:int <span class="arrow">&#45;&gt;</span></span>
  <span>?quality:float <span class="arrow">&#45;&gt;</span></span>
  <span>?bitrate:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-audio_info">audio_info</a></span></code></div><div class="spec-doc"><p>Create a new <code>audio_info</code> value, * filed with given values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-connection" class="anchored"><a href="#val-connection" class="anchor"></a><code><span><span class="keyword">val</span> connection : 
  <span>?user_agent:string <span class="arrow">&#45;&gt;</span></span>
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?genre:string <span class="arrow">&#45;&gt;</span></span>
  <span>?url:string <span class="arrow">&#45;&gt;</span></span>
  <span>?public:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?audio_info:<a href="#type-audio_info">audio_info</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?description:string <span class="arrow">&#45;&gt;</span></span>
  <span>?host:string <span class="arrow">&#45;&gt;</span></span>
  <span>?port:int <span class="arrow">&#45;&gt;</span></span>
  <span>?chunked:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?password:string <span class="arrow">&#45;&gt;</span></span>
  <span>?protocol:<a href="#type-protocol">protocol</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?user:string <span class="arrow">&#45;&gt;</span></span>
  <span>mount:<a href="#type-mount">mount</a> <span class="arrow">&#45;&gt;</span></span>
  <span>content_type:<a href="#type-content_type">content_type</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-connection">connection</a></span></code></div><div class="spec-doc"><p>Create a new <code>connection</code> value * with default values. * * <code>mount</code> is mandatory when using the <code>Http</code> protocol. * <code>icy_id</code> is mandatory to support multiple shoutcast sources * on shoutcast v2. * * <code>host</code> is <code>&quot;localhost&quot;</code> by default. * <code>password</code> is <code>&quot;hackme&quot;</code> by default. * <code>user</code> is <code>&quot;source&quot;</code> by default. Change <code>user</code> only if you know * what your are doing. * <code>protocol</code> is <code>Http</code> by default. * <code>port</code> is <code>8000</code> by default. * <code>chunked</code> is <code>false</code> by default and only works with HTTP/1.1-capable * servers. * * The list of preset headers for <code>Http</code> connections is: * <code>&quot;User-Agent&quot;</code>, <code>&quot;ice-name&quot;</code>, <code>&quot;ice-genre&quot;</code>, * <code>&quot;ice-url&quot;</code>, <code>&quot;ice-public&quot;</code>, <code>&quot;ice-audio-info&quot;</code>, * <code>&quot;ice-description&quot;</code>. * * The list of preset headers for <code>Icy</code> connections is: * <code>&quot;User-Agent&quot;</code>, <code>&quot;icy-name&quot;</code>, <code>&quot;icy-url&quot;</code>, <code>&quot;icy-pub&quot;</code>, * <code>&quot;icy-genre&quot;</code>, <code>&quot;icy-br&quot;</code>. * * Additionally, you can also add: * <code>&quot;icy-irc&quot;</code>, <code>&quot;icy-icq&quot;</code> and <code>&quot;icy-aim&quot;</code> but these are not added * by this function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-connect" class="anchored"><a href="#val-connect" class="anchor"></a><code><span><span class="keyword">val</span> connect : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-connection">connection</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Connect a handler.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-update_metadata" class="anchored"><a href="#val-update_metadata" class="anchor"></a><code><span><span class="keyword">val</span> update_metadata : <span>?charset:string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-metadata">metadata</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Update metadata on a handler. Useful only for non-ogg data format, * and if <code>icy_cap</code> is <code>true</code> for <code>Icy</code> connections. * * For <code>Icy</code> protocol, the relevant metadata are only <code>&quot;song&quot;</code> * and <code>&quot;url&quot;</code>. * * Raises: <code>Error Not_connected</code> * if not connected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-manual_update_metadata" class="anchored"><a href="#val-manual_update_metadata" class="anchor"></a><code><span><span class="keyword">val</span> manual_update_metadata : 
  <span>host:string <span class="arrow">&#45;&gt;</span></span>
  <span>port:int <span class="arrow">&#45;&gt;</span></span>
  <span>protocol:<a href="#type-protocol">protocol</a> <span class="arrow">&#45;&gt;</span></span>
  <span>user:string <span class="arrow">&#45;&gt;</span></span>
  <span>password:string <span class="arrow">&#45;&gt;</span></span>
  <span>mount:<a href="#type-mount">mount</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?connection_timeout:float <span class="arrow">&#45;&gt;</span></span>
  <span>?timeout:float <span class="arrow">&#45;&gt;</span></span>
  <span>?headers:<span><span>( string, string )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?bind:string <span class="arrow">&#45;&gt;</span></span>
  <span>?charset:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-metadata">metadata</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Manually update metadata on any source without necessarily * being connected to it for streaming. * * Optional <code>timeout</code> is <code>30.</code> by default. * * Use it only if you know what you are doing !</p></div></div><div class="odoc-spec"><div class="spec value" id="val-send" class="anchored"><a href="#val-send" class="anchor"></a><code><span><span class="keyword">val</span> send : <span>?offset:int <span class="arrow">&#45;&gt;</span></span> <span>?length:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Send data to a source connection. * * Raises: <code>Error Not_connected</code> * if not connected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-close" class="anchored"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close a source connection. * * Raises: <code>Error Not_connected</code> * if not connected.</p></div></div></div></body></html>